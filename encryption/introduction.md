[TOC]

# 加密算法

介绍加密算法的种类，以及国际算法和国密算法的对比：

## 对称加密

对称加密，顾名思义，加密方与解密方使用同一钥匙(密钥)。具体一些就是，发送方通过使用相应的加密算法和密钥，对将要发送的信息进行加密；对于接收方而言，使用解密算法和相同的密钥解锁信息，从而有能力理解对方的信息。

### DES

DES算法是在美国NSA(国家安全局)资助下由IBM公 司开发的密码算法，其初衷是为政府非机密的敏感信息提供较强的加密保护。它是美国政府担保的第一种加密算法，并在1977年被正式作为美国联邦信息处理标 准。DES主要提供非军事性质的联邦政府机构和私营部门使用，并迅速成为名声最大，使用最广的商用密码算法。

DES使用的密钥表面上是64位的，然而只有其中的56位被实际用于算法，其余8位可以被用于奇偶校验，并在算法中被丢弃。因此，DES的有效密钥长度为56位，通常称DES的密钥长度为56位。假设秘钥为56位，采用暴力破Jie的方式，其秘钥个数为2的56次方，那么每纳秒执行一次解密所需要的时间差不多1年的样子。当然，没人这么干。DES现在已经不是一种安全的加密方法，主要因为它使用的56位密钥过短。

### IDEA

国际数据加密算法(International Data Encryption Algorithm)。秘钥长度128位，优点没有专利的限制。

### AES

当 DES 被破解以后，没过多久推出了 AES 算法，提供了三种长度供选择，128 位、192 位和 256，为了保证性能不受太大的影响，选择 128 即可。

### SM1 & SM4

国际的DES算法和国产的SM4算法的目的都是为了加密保护静态储存和传输信道中的数据。

从算法上看，国产SM4算法在计算过程中增加非线性变换，理论上能大大提高其算法的安全性，并且由专业机构进行了密码分析，民间也对21轮SM4进行了差分密码分析，结论均为安全性较高。

|      | 秘钥长度    | 加密强度 | 性能 | 版权 |
| ---- | ----------- | -------- | ---- | ---- |
| DES  | 56          | 弱       | 快   | 美国 |
| 3DES | 168         | 中       | 慢   | 美国 |
| IDEA | 128         | 强       | 中   | 瑞士 |
| AES  | 128 192 256 | 强       | 快   | 美国 |
| SM1  | 128         | 强       |      | 中国 |
| SM4  | 128         | 强       |      | 中国 |





## 非对称算法

在对称加密中，发送方与接收方使用相同的密钥。那么在非对称加密中则是发送方与接收方使用的不同的密钥。其主要解决的问题是防止在秘钥协商的过程中发生泄漏。比如在对称加密中，小蓝将需要发送的消息加密，然后告诉你密码是123balala,ok,对于其他人而言，很容易就能劫持到密码是123balala。那么在非对称的情况下，小蓝告诉所有人密码是123balala,对于中间人而言，拿到也没用，因为没有私钥。所以，非对称密钥其实主要解决了密钥分发的难题。

![asymmetric](https://github.com/whyshrha/CodeNotes/blob/master/encryption/pic/asymmetric.png)

### RSA

RSA算法由Rivest、Shamir、Adleman于1978年首次发表，是迄今为止最容易理解和实现的公钥算法，已经受住了多年深入的攻击，其理论基础是一种特殊的可逆模幂运算，其安全性基于分解大整数的困难性。

RSA算法既可用于加密，又可用于数字签名，已得到广泛采用，并被许多标准化组织(如ISO、ITU、IETF和SWIFT等)接纳。目前许多国家标准仍采用RSA算法或它的变型。

### ECC

基于椭圆曲线提出。是目前加密强度最高的非对称加密算法

### SM2

SM2算法由国家密码管理局于2010年12月17日发布，全称为椭圆曲线算法。椭圆曲线并不是椭圆，之所以称为椭圆曲线是因为它们是用三次方程来表示的，并且该方程与计算椭圆周长的方程相似。最大优势就是国家认可和大力支持。

|      | 加密强度 | 秘钥生成性能 | 加解密性能 | 版权    |
| ---- | -------- | ------------ | ---------- | ------- |
| RSA  | 弱       | 慢           | 快         | RSA公司 |
| ECC  | 强       | 快           | 慢         | 争议    |
| SM2  | 强       | 快           | 慢         | 中国    |







## 散列算法

这个大家应该更加熟悉了，比如我们平常使用的MD5校验，在很多时候，我并不是拿来进行加密，而是用来获得唯一性ID。在做系统的过程中，存储用户的各种密码信息，通常都会通过散列算法，最终存储其散列值。

也叫杂凑算法、摘要算法。

### MD5

MD5 可以用来生成一个 128 位的消息摘要，它是目前应用比较普遍的散列算法。虽然，因为算法的缺陷，它的唯一性已经被破解了，但是大部分场景下，这并不会构成安全问题。但是，如果不是长度受限（32 个字符），还是不推荐你继续使用 MD5 的。

2005年,Wang等人给出了MD5算法和SHA-1算法的碰撞攻击方法，现今被广泛应用的MD5算法和SHA-1算法不再是安全的算法。

### SHA

安全散列算法。SHA分为SHA1和SH2两个版本。该算法的思想是接收一段明文，然后以一种不可逆的方式将它转换成一段（通常更小）密文，也可以简单的理解为取一串输入码（称为预映射或信息），并把它们转化为长度较短、位数固定的输出序列即散列值（也称为信息摘要或信息认证代码）的过程。

### SM3

SM3密码摘要算法是中国国家密码管理局2010年公布的中国商用密码杂凑算法标准。SM3算法适用于商用密码应用中的数字签名和验证，是在SHA- 256基础上改进实现的一种算法。SM3算法采用Merkle-Damgard结构，消息分组长度为512位，摘要值长度为256位。SM3算法的压缩函数与SHA-256的压缩函数具有相似的结构,但是SM3算法的设计更加复杂，比如压缩函数的每一轮都使用2个消息字。

现今为止，SM3算法的安全性相对较高。

|      | 加密强度 | 冲突概率 | 安全性 | 性能 |
| ---- | -------- | -------- | ------ | ---- |
| MD5  | 128      | 中       | 中     | 中   |
| SHA  | 160 256  | 低       | 高     | 慢   |
| SM3  | 256      | 低       | 高     |      |

至此，总结看，大部分情况下使用对称加密，具有比较不错的安全性。如果需要分布式进行秘钥分发，考虑非对称。如果不需要可逆计算则散列算法。





## 国产总结

国产密码算法（国密算法）是指国家密码局认定的国产商用密码算法，目前主要使用公开的SM2、SM3、SM4三类算法，分别是非对称算法、哈希算法和对称算法。

**国家密码管理局**关于SM2、SM3算法的公告介绍。http://www.oscca.gov.cn/sca/xxgk/bzgf.shtml







# 详细介绍常用的

## MD5

### 概述

MD5信息摘要算法（MD5 Message-Digest Algorithm）是一种被广泛使用的密码散列函数，由MD4改进而来。[点我看MD4算法原理。](https://zhuanlan.zhihu.com/p/114263973)

MD5本质上是一个哈希函数。但是MD5具有雪崩效应（Avalanche Effect）、抗碰撞性等的性质。为了保证这些性质，MD5的算法设计比较复杂。下面就来说明MD5算法的原理。

MD5算法的处理步骤可以概括为三步：数据填充、分组循环变换、拼接输出。

### 实现步骤

参考：https://zhuanlan.zhihu.com/p/115270932



### “破解”方式

**所谓的“破解”指的是“碰撞”。**即找到一个原文，算出来的MD5码和已知的MD5码一样。接下来介绍一些常见的破解方法。



一、穷举法和字典法

认为它们的本质是一样的，都是利用计算机的资源尝试碰撞已知的MD5码。这里就放在一起了。

**穷举法非常简单，就是不停地尝试各种字符的排列组合，看哪一个组合的MD5码能对上。**可惜缺点是太耗费时间了。我们举个栗子，假设我们要破解一个6位大小写字母和数字混合的密码，那么一共有 ![[公式]](https://www.zhihu.com/equation?tex=%2826%2B26%2B10%29%5E%7B6%7D) 种组合。这个数的大小超过500亿。

既然计算如此费时，能不能考虑**把计算结果以映射表的形式存放起来，一个萝卜一个坑**，一个原文对应着一个MD5码呢？可以呀！这就是传说中的“字典法”。将已知的MD5码查表，直接反查出原文。**字典法体现了算法设计的“以空间换时间”的思想。**缺点是比较耗费空间。不过现在硬盘的价格变得白菜价了，空间开销不算什么。

这是一个用字典法破解MD5的网站：https://www.cmd5.com/password.aspx



二、时间和空间的折中：哈希链表&彩虹表法

如果说穷举法太耗费时间，字典法太耗费存储空间的话，我们能不能考虑在时间消耗和空间消耗之间折中呢？我们可以考虑用链表将一系列有意义的原文和MD5码串起来。

要构造这样的链表，我们需要两个函数：哈希函数H(x)和衰减函数（reduction function）R(x)。哈希函数可以是MD5，也可以是其他的消息摘要算法。H(x)的值域是R(x)的定义域，R(x)的值域是H(x)的定义域。**R(x)不是H(x)的反函数。**

将一个原文不停地使用H(x)和R(x)交替进行运算k次，再将原文本身和运算结果以链表的形式串接起来，就可以得到结点个数为2k+1的链表。实际存放的时候只存放首端和末端两个原文即可。**这种链表叫做“哈希链表”，体现了算法设计的“时空权衡”（Space and Time Tradeoffs）。**

举个栗子，假设原文s=abcabc，经过2次交替运算，得到以下的链表：

abcabc->H(x)->3C8B0D7A->R(x)->eopmca->H(x)->7E9F216C->R(x)->rapper

以上数据均为举例编造的，仅为说明原理使用。那我们存放这个链表的时候，只需要记录abcabc和rapper两个原文即可。

假设我们要破解的摘要值（哈希链表的H(x)不一定是MD5算法，这里用更准确的说法代替MD5码）是7E9F216C，经过R(x)运算得到rapper，说明我们要寻找的原文就在以rapper为末端的哈希链表中。从首端开始经过多次运算，我们发现eopmca的摘要值就是7E9F216C。于是就反查出7E9F216C对应的原文是eopmca。

**如果在生成哈希链表的时候依次使用多个不一样的R(x)，此时的哈希链表就是“彩虹表”。**



这里有已经计算好的彩虹表：http://project-rainbowcrack.com/table.htm







## SM3

国家密码管理局的介绍：http://www.oscca.gov.cn/sca/xxgk/2010-12/17/content_1002389.shtml



### 概述

SM3密码杂凑算法是中国国家密码管理局2010年公布的中国商用密码杂凑算法标准。具体算法标准原始文本参见本小节国家密码管理局的链接。该算法于2012年发布为密码行业标准(GM/T 0004-2012)，2016年发布为国家密码杂凑算法标准(GB/T 32905-2016)。

SM3适用于商用密码应用中的数字签名和验证，是在SHA-256基础上改进实现的一种算法，其**安全性和SHA-256相当**。SM3和MD5的迭代过程类似，也采用Merkle-Damgard结构。消息分组长度为512位，摘要值长度为256位。

整个算法的执行过程可以概括成四个步骤：消息填充、消息扩展、迭代压缩、输出结果。

### 实现步骤

参照：https://zhuanlan.zhihu.com/p/129692191



### 国家密码管理局

提到消息摘要算法，大家耳熟能详的是MD5、SHA-1这些经典算法。不过这些算法早已被攻破。为了保障信息安全，国家密码管理局于2010年制定并公布了一系列国产密码算法，简称国密算法。

国密算法有很多，具体包括SM1、SM2、SM3、SM4、SM7、SM9、ZUC祖冲之算法等。其中SM2、SM3、SM4是公开的。



其中对称密码算法包括SM1，SM4和SM7，非对称密码算法包括SM2，SM9，哈希算法包括SM3。

SM1算法仅支持硬件实现，目前使用范围逐渐萎缩，目前主要在存量市场有所使用。

SM2算法对标RSA、ECC算法，算法标准已公开。

SM3算法对标MD5、SHA-256等哈希算法，算法标准已公开。

SM4算法对标AES，3DES等算法，算法标准已公开。

SM7算法针对非接触式IC卡、票务、支付卡类应用，算法标准已公开。

SM9算法对标国际IBC算法，是基于标识的非对称密码算法体系，该算法于2016年正式发布，在应用的成熟度方面还在不断完善，目前在电子邮件领域有一些实际应用。

ZUC算法是我国第一个走向国际的国密算法，对标国际的RC4算法，属于对称密码算法中的序列密码算法，目前主要是承担LTE网络中语音流加密的功能。



## Github开源

http://gmssl.org/

GmSSL是一个开源的密码工具箱，支持SM2/SM3/SM4/SM9/ZUC等国密(国家商用密码)算法、SM2国密数字证书及基于SM2证书的SSL/TLS安全通信协议，支持国密硬件密码设备，提供符合国密规范的编程接口与命令行工具，可以用于构建PKI/CA、安全通信、数据加密等符合国密标准的安全应用。

Linux安装学习 https://www.cnblogs.com/tinywan/p/7230039.html

GmSSL Success in Mac.2020-05-10

SM3 (GM/T 0004-2012): cryptographic hash function with 256-bit digest length.







# 个人理解

对称加密： 可以加密，解密。

非对称加密：配对的公钥-密钥，进行加密解密。

哈希：唯一标识，例如两个很大的文件是否为同一个文件，可以利用哈希。每个文件有个签名码，也是这个原理。





# 参考

https://www.cxyxiaowu.com/9235.html

MD5 https://zhuanlan.zhihu.com/p/115270932

国密分类 https://www.zhihu.com/question/380328694?sort=created

